# 연관성 분석   
대량의 데이터에 숨겨진 항목 간의 연관규칙을 찾아내는 기법   
market basket analysis: 여러 사람의 장바구니에서 특정한 규칙을 찾아내는 기법

> 기저귀를 맥주와 함께 살 확률

> 연관분석을 통해 도출된 연관성 규칙은 조건과 결과로 구성
```
{조건} => {결과}
```
```
"와인과 소금을 사면 치즈를 산다" : {와인, 소금} => {치즈}
"치즈를 사면 와인과 소금을 산다" : {치즈} => {와인, 소금}
```

도출된 연관성 규칙들이 얼마나 의미있는지 평가하는 기준   
1. 지지도(support)   
2. 신뢰도(confidence)   
3. 향상도(lift)   
   
상품진열, 보험 부정행위 적발, 카탈로그 디자인, 신상품 카테고리 구성 등에 활용

|거래ID|구매물품|
|:--|:--|
|#1|삼겹살, 생수, 소주, 과자|
|#2|삼겹살, 생수, 소주, 사과|
|#3|장어, 생수, 소주, 양파|
|#4|땅콩, 생수, 맥주, 오이|
|#5|땅콩, 생수, 맥주, 감|

> 연관성규칙   
|{삼겹살, 생수} => {사과}|   
|{생수} => {사과}|   
|{삼겹살} => {생수}|   
|{삼겹살} => {소주}|   
|{땅콩} => {맥주}|   

## 지지도   
지지도란 전체거래 중 연관성 규칙을 구성하는 항목들이 포함된 거래의 비율을 의미   
> 지지도 = (조건과 결과항목을 포함하는 거래 수) / (전체 거래 수)  
= 빈도수

|연관성규칙|지지도|수식 
|:--|:--|:--| 
|{삼겹살, 생수} => {사과}|1/5|(삼겹살, 생수, 사과)포함 거래 / 전체거래|
|{생수} => {사과}|1/5|(생수, 사과)포함 거래 / 전체거래|
|{삼겹살} => {생수}|2/5|(삼겹살, 생수)포함 거래 / 전체거래|
|{삼겹살} => {소주}|2/5|(삼겹살, 소주)포함 거래 / 전체거래|
|{땅콩} => {맥주}|2/5|(땅콩, 맥주)포함 거래 / 전체거래|

## 신뢰도
조건이 발생했을 때 결과가 동시에 일어날 확률. 신뢰도가 1에 가까울수록 의미있는 연관성
> 신뢰도 = (조건과 결과항목을 포함하는 거래 수) / (조건 항목을 포함하는 거래 수)

|연관성규칙|신뢰도|수식 
|:--|:--|:--| 
|{삼겹살, 생수} => {사과}|1/2|(삼겹살, 생수, 사과)포함 거래 / (삼겹살, 생수)포함 거래|
|{생수} => {사과}|1/5|(사과)포함 거래 / (생수)포함 거래|
|{삼겹살} => {생수}|2/2|(삼겹살, 생수)포함 거래 / (삼겹살)포함거래|
|{삼겹살} => {소주}|2/2|(삼겹살, 소주)포함 거래 / (삼겹살)포함거래|
|{땅콩} => {맥주}|2/2|(땅콩, 맥주)포함 거래 / (땅콩)포함거래|   

결과항목에 생수가 포함되어 있으면 신뢰도는 무조건 1이다.   
모든 거래에서 발생한 항목 = 우연히 발생한 확률   

## 향상도
우연적인 관계를 감안해 산출하는 지표
> 향상도 = 연관성 규칙의 지지도 / 조건의 지지도 * 결과의 지지도   
향상도 값이 1인 경우 조건과 결과는 우연에 의한 관계

|연관성규칙|지지도|신뢰도|향상도|
|:--|:--|:--|:--|
|{삼겹살, 생수} => {사과}|1/5|1/2|0.2/(0.4*0.2)=2.5|
|{생수} => {사과}|1/5|1/5|0.2/(1*0.2)=1|
|{삼겹살} => {생수}|2/5|2/2|0.4/(0.4*1)=1|
|{삼겹살} => {소주}|2/5|2/2|0.4/(0.4*0.6)=1.67|
|{땅콩} => {맥주}|2/5|2/2|0.4/(0.4*0.4)=2.5|